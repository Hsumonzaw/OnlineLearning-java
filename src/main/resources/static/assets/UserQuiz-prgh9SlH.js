import{s as _}from"./QuizService-C7pySIqU.js";import{J as S,K as k,H as z,X as L,d as b,B as R,Y as T,aT as A,a5 as F,_ as q,c as f,w as r,b as Q,o as n,a,j as p,aw as y,h as g,t as d,C as E,F as B,k as N,e as P,f as D,p as C,m as Y,u as M,s as U}from"./index-53ut1aa4.js";import{V as G}from"./VChip-CK8SP7y-.js";import{c as j,m as H}from"./VInput-DLSwO6jY.js";import{V as J,a as v}from"./VRadioGroup-CmWjbS-o.js";import"./VSelectionControl-nb06iGDz.js";const K=k({...F(),...H()},"VForm"),O=S()({name:"VForm",props:K(),emits:{"update:modelValue":t=>!0,submit:t=>!0},setup(t,e){let{slots:u,emit:h}=e;const s=j(t),c=z();function o(i){i.preventDefault(),s.reset()}function w(i){const m=i,l=s.validate();m.then=l.then.bind(l),m.catch=l.catch.bind(l),m.finally=l.finally.bind(l),h("submit",m),m.defaultPrevented||l.then(I=>{var V;let{valid:x}=I;x&&((V=c.value)==null||V.submit())}),m.preventDefault()}return L(()=>{var i;return b("form",{ref:c,class:T(["v-form",t.class]),style:R(t.style),novalidate:!0,onReset:o,onSubmit:w},[(i=u.default)==null?void 0:i.call(u,s)])}),A(s,c)}}),X={data(){return{quizList:[],userAnswers:{},loadError:!1,showResult:!1,score:0,passingScore:.6,languagesId:0,coursesId:0,minutes:"0m 0s",minutesCount:0}},mounted(){this.startTimer(),this.languagesId=this.$route.query.languagesId,this.coursesId=this.$route.query.coursesId,_.getExamMark(this.languagesId).then(t=>{t>0?this.$router.push({path:"/certificate"}).catch(()=>{}):this.fetchQuiz()}).catch(()=>{this.loadError=!0})},methods:{startTimer(){this.timerSeconds=setInterval(()=>{this.minutesCount+=1;const t=Math.floor(this.minutesCount/60),e=this.minutesCount%60;this.minutes=`${t}m ${e}s`},1e3)},goToCertificate:function(t){this.$router.push({path:t}).catch(()=>{})},fetchQuiz(){_.getQuizStudent(this.languagesId).then(t=>{this.quizList=t,this.quizList.forEach(e=>{this.$set(this.userAnswers,e.quizId,null)})}).catch(()=>{this.loadError=!0})},submitQuiz(){if(clearInterval(this.timerSeconds),!this.quizList.every(e=>this.userAnswers[e.quizId]!==null)){this.$swal("Please answer all questions before submitting.");return}this.score=this.quizList.reduce((e,u)=>{const h=this.getCorrectAnswerText(u);return e+(this.userAnswers[u.quizId]===h?1:0)},0),this.showResult=!0,localStorage.getItem("userName"),this.score,this.quizList.length,new Date().toISOString(),this.userAnswers,_.saveAns(this.coursesId,this.quizList,this.minutesCount).then(e=>{}).catch(()=>{this.loadError=!0})},getCorrectAnswerText(t){switch(t.correct){case 1:return t.ansone;case 2:return t.anstwo;case 3:return t.ansthree;default:return null}}}},W={key:0},Z={class:"font-weight-medium mb-2"},$={key:0,class:"text-success font-weight-bold mt-2"},ee={key:1,class:"text-error font-weight-bold mt-2"};function te(t,e,u,h,s,c){return n(),f(Q,{class:"pa-8","max-width":"700"},{default:r(()=>[e[4]||(e[4]=b("h2",{class:"text-h4 mb-6 text-center"},"Quiz",-1)),a(G,{class:"ma-2",color:"blue lighten-4","text-color":"blue darken-2"},{default:r(()=>[g(" ⏳ Time: "+d(s.minutes),1)]),_:1}),s.quizList.length?(n(),p("div",W,[a(O,{ref:"form",onSubmit:E(c.submitQuiz,["prevent"])},{default:r(()=>[(n(!0),p(B,null,N(s.quizList,(o,w)=>(n(),f(P,{key:o.quizId,class:"mb-6"},{default:r(()=>[a(D,{cols:"12"},{default:r(()=>[b("div",Z," Q"+d(w+1)+": "+d(o.name),1),a(J,{modelValue:o.ans,"onUpdate:modelValue":i=>o.ans=i,mandatory:!0,disabled:s.showResult},{default:r(()=>[a(v,{label:o.ansone,value:1,dense:"",color:"primary"},null,8,["label"]),a(v,{label:o.anstwo,value:2,dense:"",color:"primary"},null,8,["label"]),a(v,{label:o.ansthree,value:3,dense:"",color:"primary"},null,8,["label"])]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024)]),_:2},1024))),128)),a(C,{color:"primary",class:"mt-4",type:"submit"},{default:r(()=>e[1]||(e[1]=[g(" Submit ")])),_:1,__:[1]})]),_:1},8,["onSubmit"])])):y("",!0),s.showResult?(n(),f(Y,{key:1,class:"mt-6 pa-4",outlined:""},{default:r(()=>[a(M,null,{default:r(()=>e[2]||(e[2]=[g("Your Result")])),_:1,__:[2]}),a(U,null,{default:r(()=>[b("div",null," You scored "+d(s.score)+" out of "+d(s.quizList.length)+" ( "+d((s.score/s.quizList.length*100).toFixed(2))+"% ) ",1),s.score>=s.passingScore?(n(),p("div",$," 🎉 Congratulations! You passed and can generate your certificate. ")):(n(),p("div",ee," Sorry, you did not pass. Please try again. ")),s.score>=s.passingScore*s.quizList.length?(n(),f(C,{key:2,color:"success",class:"mt-4",onClick:e[0]||(e[0]=o=>c.goToCertificate("/certificate"))},{default:r(()=>e[3]||(e[3]=[g(" Generate Certificate ")])),_:1,__:[3]})):y("",!0)]),_:1})]),_:1})):y("",!0)]),_:1,__:[4]})}const ue=q(X,[["render",te],["__scopeId","data-v-564b9fa7"]]);export{ue as default};
