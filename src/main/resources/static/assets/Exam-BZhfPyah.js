import{s as B}from"./LanguageService-C8OwBagN.js";import{s as E}from"./UserAccountService-6cOQmFSE.js";import{s as y}from"./CoursesService-sqNePa8B.js";import{_ as D,j as f,a as t,w as a,b as L,F as w,o as d,e as k,f as T,k as $,c as A,m as h,d as V,t as C,p as n,u as b,g as F,h as i,s as v,v as q,q as M,x as c,A as S}from"./index-53ut1aa4.js";import{V as N}from"./VDialog-0H5vlJ4f.js";import{V as P}from"./VDatePicker-BhS8khmY.js";import{V as o}from"./VTextField-C3sPCMKT.js";import{V as R,a as U}from"./VRadioGroup-CmWjbS-o.js";import{f as I}from"./format-CBpsKyOP.js";import"./VInput-DLSwO6jY.js";import"./VSelectionControl-nb06iGDz.js";const O={data:()=>({languageList:[],languagesId:0,languageList:[],selectedOne:{},userData:{},lessonList:[],showEnrollButton:!0,showForm:!1,user:{userType:"STUDENT"},saveOrupdate:"SAVE",rules:{required:e=>!!e||"This field is required",email:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||"Invalid email format",phone:e=>/^(?:\+?95|0)(?:9\d{7,9})$/.test(e)||"Invalid Myanmar phone number",nrc:e=>/^\d{1,12}\/[A-Z]{3}\([A-Z]\)\d{6}$/.test(e)||"Invalid NRC format"},userTypeList:["ALL","STAFF","STUDENT","TEACHER","ADMIN"],startPicker:new Date,startMenu:!1,dialogBuyNow:!1,rgType:"exam"}),mounted(){this.languageListMethod(),this.user.startDate=I(this.startPicker,"dd-MM-yyyy"),this.userData=JSON.parse(localStorage.getItem("user"))||{}},methods:{clickBuyNowType:function(){this.dialogBuyNow=!1;let e={studentDto:{}};e.type=this.rgType,e.receivedDate=this.user.startDate,e.studentDto.userAccountId=this.userData.userId,e.languagesDto={languagesId:this.selectedOne.languagesId},e.amount=this.selectedOne.amount,y.addCourse(e).then(s=>{const u=this.languageList.find(r=>r.languagesId===this.selectedOne.languagesId);u&&(u.buy=1),this.$swal({icon:"success",title:"Your work saved successfully!",showConfirmButton:!1,timer:1e3}).then(()=>{})})},handleExam(e){this.selectedOne=e,this.userData.role==null?this.$swal({title:"Enroll Now",text:"Register as a student to access all lessons.",icon:"info",showCancelButton:!0,confirmButtonText:"Register",cancelButtonText:"Cancel"}).then(s=>{s.isConfirmed&&(this.showForm=!0)}):this.$swal({title:"Buy Now",text:"Now Now",icon:"info",showCancelButton:!0,confirmButtonText:"Buy",cancelButtonText:"Cancel"}).then(s=>{s.isConfirmed&&(this.dialogBuyNow=!0)})},async saveUser(){var e,s,u;try{let r=this.user.userType;typeof r=="object"&&(r=r.userType||r.value||""),this.user.userType=r,((e=this.loggedInUser)==null?void 0:e.role)==="TEACHER"&&r==="STUDENT"?this.user.teacherId=this.loggedInUser.userId:this.user.teacherId=0,E.saveFreeUserAccounts(this.user).then(p=>{this.$router.push({path:"/login"}).catch(()=>{})}).catch(p=>{this.$swal("Fail!",p.response.data.message,"error")})}catch(r){this.showForm=!1,console.error("User save failed",r),this.$swal("Error",((u=(s=r.response)==null?void 0:s.data)==null?void 0:u.message)||"Failed to save user","error")}},clickTakeExam:function(e){let s=e.languagesId,u=e.coursesId,r={languagesId:s,coursesId:u};this.$router.push({name:"userquiz",query:r})},coursesListMethod(){this.showTeacher=!1,y.getCourseList().then(e=>{this.coursesList.splice(0),this.coursesList.push(...e)}).catch(e=>console.error("Fetch error:",e))},languageListMethod(){B.getLanguageList(this.languagesId).then(e=>{this.languageList.splice(0,this.languageList.length),this.languageList.push(...e),console.log(this.languageList)}).catch(e=>{this.$swal("Fail!",e.response.data.message,"error")})}},watch:{startPicker(){this.startMenu=!1,this.user.startDate=I(this.startPicker,"dd-MM-yyyy")}}},x={class:"flex-grow-1 d-flex flex-column justify-center"},j={class:"mb-3 font-weight-bold text-wrap product-title",style:{"font-size":"18px"}},z=["onClick"],H=["onClick"];function Z(e,s,u,r,p,m){return d(),f(w,null,[t(L,{fluid:"",class:"py-10"},{default:a(()=>[t(k,{"no-gutters":""},{default:a(()=>[t(T,{cols:"12",md:"12",class:"px-2 mt-6 pt-2 pb-1"},{default:a(()=>[t(k,{"no-gutters":"",align:"stretch"},{default:a(()=>[(d(!0),f(w,null,$(e.languageList,l=>(d(),A(T,{key:l.languagesId,cols:"12",sm:"12",md:"3",class:"mt-4"},{default:a(()=>[t(h,{class:"pa-6 text-center ml-2 h-100 d-flex flex-column",variant:"text"},{default:a(()=>[V("div",x,[V("p",j,C(l.name),1)]),t(n,null,{default:a(()=>[l.buy==1?(d(),f("a",{key:0,onClick:g=>m.clickTakeExam(l),class:"font-weight-bold learn-more-btn"},"Take Exam",8,z)):(d(),f("a",{key:1,onClick:g=>m.handleExam(l),class:"font-weight-bold learn-more-btn"},"Start Now",8,H))]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(N,{modelValue:e.showForm,"onUpdate:modelValue":s[13]||(s[13]=l=>e.showForm=l),"max-width":"600",style:{height:"730px"}},{default:a(()=>[t(h,{class:"form pa-1",elevation:"4","mb-0":""},{default:a(()=>[t(b,{class:"d-flex justify-space-between align-center"},{default:a(()=>[s[19]||(s[19]=V("span",{class:"text-h4"},"Add User",-1)),t(n,{icon:"",color:"red",onClick:s[0]||(s[0]=l=>e.showForm=!1)},{default:a(()=>[t(F,null,{default:a(()=>s[18]||(s[18]=[i("mdi-close")])),_:1,__:[18]})]),_:1})]),_:1,__:[19]}),t(v,null,{default:a(()=>[t(q,{modelValue:e.startMenu,"onUpdate:modelValue":s[3]||(s[3]=l=>e.startMenu=l),"full-width":"","max-width":"200px","min-width":"290px","close-on-content-click":!1},{activator:a(({props:l})=>[t(o,M({modelValue:e.user.startDate,"onUpdate:modelValue":s[1]||(s[1]=g=>e.user.startDate=g),density:"compact",variant:"outlined",label:"From Date",readonly:""},l),null,16,["modelValue"])]),default:a(()=>[t(P,{modelValue:e.startPicker,"onUpdate:modelValue":s[2]||(s[2]=l=>e.startPicker=l),color:"primary","hide-header":""},null,8,["modelValue"])]),_:1},8,["modelValue"]),t(o,{label:"Name",modelValue:e.user.name,"onUpdate:modelValue":s[4]||(s[4]=l=>e.user.name=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"]),t(o,{label:"User Name",modelValue:e.user.userName,"onUpdate:modelValue":s[5]||(s[5]=l=>e.user.userName=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"]),t(o,{label:"Age",modelValue:e.user.age,"onUpdate:modelValue":s[6]||(s[6]=l=>e.user.age=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"]),t(o,{modelValue:e.user.nrc,"onUpdate:modelValue":s[7]||(s[7]=l=>e.user.nrc=l),label:"NRC",rules:[e.rules.required,e.rules.nrc],required:""},null,8,["modelValue","rules"]),t(o,{modelValue:e.user.email,"onUpdate:modelValue":s[8]||(s[8]=l=>e.user.email=l),label:"Email",rules:[e.rules.required,e.rules.email],required:""},null,8,["modelValue","rules"]),t(o,{label:"Password",modelValue:e.user.password,"onUpdate:modelValue":s[9]||(s[9]=l=>e.user.password=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"]),t(o,{modelValue:e.user.phonenum,"onUpdate:modelValue":s[10]||(s[10]=l=>e.user.phonenum=l),label:"Phone Number",rules:[e.rules.required,e.rules.phone],required:""},null,8,["modelValue","rules"]),t(o,{label:"Address",modelValue:e.user.address,"onUpdate:modelValue":s[11]||(s[11]=l=>e.user.address=l)},null,8,["modelValue"])]),_:1}),t(c,{class:"justify-end pr-5"},{default:a(()=>[t(n,{class:"text-black",style:{"background-color":"#2196f3"},onClick:s[12]||(s[12]=l=>m.saveUser())},{default:a(()=>[i(C(e.saveOrupdate),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(N,{modelValue:e.dialogBuyNow,"onUpdate:modelValue":s[17]||(s[17]=l=>e.dialogBuyNow=l),width:"500"},{default:a(()=>[t(h,null,{default:a(()=>[t(b,{class:"text-h5 white--text bg-red"},{default:a(()=>s[20]||(s[20]=[i("Buy ")])),_:1,__:[20]}),t(v,{class:"text-h6"},{default:a(()=>[t(R,{modelValue:e.rgType,"onUpdate:modelValue":s[14]||(s[14]=l=>e.rgType=l),inline:""},{default:a(()=>[t(U,{label:"Courses",value:"COURSES"}),t(U,{label:"Exam",value:"EXAM"})]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:a(()=>[t(S),t(n,{class:"black",text:"",onClick:s[15]||(s[15]=l=>e.dialogBuyNow=!1)},{default:a(()=>s[21]||(s[21]=[i("CANCEL")])),_:1,__:[21]}),t(n,{dark:"",class:"bg-red",text:"",onClick:s[16]||(s[16]=l=>m.clickBuyNowType())},{default:a(()=>s[22]||(s[22]=[i("SAVE")])),_:1,__:[22]})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const te=D(O,[["render",Z],["__scopeId","data-v-78fe4d7d"]]);export{te as default};
