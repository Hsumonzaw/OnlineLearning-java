import{s as I}from"./LanguageService-C8OwBagN.js";import{s as w}from"./LessonsService-1oJVq1iE.js";import{s as F}from"./UserAccountService-6cOQmFSE.js";import{_ as c,c as V,w as a,b as $,o as i,a as t,aw as q,e as b,f as L,d as n,ax as M,j as C,F as U,k as E,ay as R,az as P,h as o,t as p,m as v,u as k,aA as S,s as T,p as g,g as O,v as j,q as Y,x as N,A as H}from"./index-53ut1aa4.js";import{s as Z}from"./CoursesService-sqNePa8B.js";import{V as B}from"./VDialog-0H5vlJ4f.js";import{V as z}from"./VDatePicker-BhS8khmY.js";import{V as u}from"./VTextField-C3sPCMKT.js";import{V as G,a as D}from"./VRadioGroup-CmWjbS-o.js";import{f as A}from"./format-CBpsKyOP.js";import"./VInput-DLSwO6jY.js";import"./VSelectionControl-nb06iGDz.js";const J={data:()=>({languageList:[],selectedOne:{},userData:{},lessonList:[],showEnrollButton:!0,showForm:!1,user:{userType:"STUDENT"},saveOrupdate:"SAVE",rules:{required:e=>!!e||"This field is required",email:e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)||"Invalid email format",phone:e=>/^(?:\+?95|0)(?:9\d{7,9})$/.test(e)||"Invalid Myanmar phone number",nrc:e=>/^\d{1,12}\/[A-Z]{3}\([A-Z]\)\d{6}$/.test(e)||"Invalid NRC format"},userTypeList:["ALL","STAFF","STUDENT","TEACHER","ADMIN"],startPicker:new Date,startMenu:!1,dialogBuyNow:!1,rgType:"courses"}),mounted(){this.user.startDate=A(this.startPicker,"dd-MM-yyyy"),this.userData=JSON.parse(localStorage.getItem("user"))||{},this.languageListMethod()},methods:{clickBuyNowType:function(){this.dialogBuyNow=!1;let e={studentDto:{}};e.type=this.rgType,e.receivedDate=this.user.startDate,e.studentDto.userAccountId=this.userData.userId,e.languagesDto=this.selectedOne,e.amount=this.selectedOne.amount,Z.addCourse(e).then(s=>{this.$swal({icon:"success",title:"Your work saved successfully!",showConfirmButton:!1,timer:1e3}).then(()=>{})})},async saveUser(){var e,s,d;try{let r=this.user.userType;typeof r=="object"&&(r=r.userType||r.value||""),this.user.userType=r,((e=this.loggedInUser)==null?void 0:e.role)==="TEACHER"&&r==="STUDENT"?this.user.teacherId=this.loggedInUser.userId:this.user.teacherId=0,F.saveFreeUserAccounts(this.user).then(h=>{this.$router.push({path:"/login"}).catch(()=>{})}).catch(h=>{this.$swal("Fail!",h.response.data.message,"error")})}catch(r){console.error("User save failed",r),this.$swal("Error",((d=(s=r.response)==null?void 0:s.data)==null?void 0:d.message)||"Failed to save user","error")}},clickLanguage(e){var s;this.selectedOne=e,(s=this.userData)!=null&&s.password?this.loadLessons(e.languagesId):this.loadLessonsFree(e.languagesId)},loadLessonsFree(e){w.getLessonListFree("FREE",e).then(s=>{this.lessonList.splice(0),this.lessonList.push(...s)})},loadLessons(e){w.getLessonList("ALL",e).then(s=>{this.lessonList.splice(0),this.lessonList.push(...s),this.lessonList.filter(r=>r.freeVideo=="PAID").length>0?this.showEnrollButton=!1:this.showEnrollButton=!0})},loadLessonsFiltered(e){w.getLessonList("ALL",e).then(s=>{this.lessonList=s.filter(d=>d.freeVideo==="FREE")})},getYouTubeEmbedUrl(e){var s,d;if(!e)return null;if(e.includes("youtu.be/")){const r=(s=e.split("youtu.be/")[1])==null?void 0:s.split("?")[0];return r?`https://www.youtube.com/embed/${r}`:null}if(e.includes("youtube.com/watch?v=")){const r=(d=e.split("v=")[1])==null?void 0:d.split("&")[0];return r?`https://www.youtube.com/embed/${r}`:null}return null},languageListMethod(){I.getLanguageListFree().then(e=>{this.languageList.splice(0),this.languageList.push(...e),this.selectedOne=this.languageList[0],this.clickLanguage(this.selectedOne)}).catch(e=>{this.$swal("Fail!",e.response.data.message,"error")})},handleEnroll(){this.userData.role==null?this.$swal({title:"Enroll Now",text:"Register as a student to access all lessons.",icon:"info",showCancelButton:!0,confirmButtonText:"Register",cancelButtonText:"Cancel"}).then(e=>{e.isConfirmed&&(this.showForm=!0)}):this.$swal({title:"Buy Now",text:"Now Now",icon:"info",showCancelButton:!0,confirmButtonText:"Buy",cancelButtonText:"Cancel"}).then(e=>{e.isConfirmed&&(this.dialogBuyNow=!0)})}},watch:{startPicker(){this.startMenu=!1,this.user.startDate=A(this.startPicker,"dd-MM-yyyy")}}},X=["src"];function K(e,s,d,r,h,m){return i(),V($,{fluid:"",class:"login-full",style:{"background-color":"#f0f4f8"}},{default:a(()=>[t(b,{"no-gutters":""},{default:a(()=>[t(L,{md:"2",class:"pa-4",style:{"background-color":"white","box-shadow":"2px 0 8px rgba(0, 0, 0, 0.05)"}},{default:a(()=>[s[19]||(s[19]=n("h3",{class:"text-center font-weight-bold mb-4",style:{color:"#1565c0"}}," Languages ",-1)),t(M,{dense:"",nav:""},{default:a(()=>[(i(!0),C(U,null,E(e.languageList,(l,f)=>(i(),V(R,{key:f,active:l.languagesId==e.selectedOne.languagesId,"active-class":"selected-language",onClick:y=>m.clickLanguage(l)},{default:a(()=>[t(P,null,{default:a(()=>[o(p(l.name),1)]),_:2},1024)]),_:2},1032,["active","onClick"]))),128))]),_:1})]),_:1,__:[19]}),t(L,{md:"10",class:"pa-4"},{default:a(()=>[t(b,null,{default:a(()=>[(i(!0),C(U,null,E(e.lessonList,(l,f)=>(i(),V(L,{key:f,cols:"12",md:"6",lg:"4",class:"mb-6"},{default:a(()=>[t(v,{elevation:"5",class:"rounded-xl bg-light-purple",style:{height:"100%"}},{default:a(()=>[t(k,{class:"font-weight-bold text-primary",style:{"min-height":"64px"}},{default:a(()=>{var y;return[o(p(((y=l.languagesDto)==null?void 0:y.name)||"Untitled Lesson"),1)]}),_:2},1024),t(S,{"aspect-ratio":"16/9"},{default:a(()=>[n("iframe",{src:m.getYouTubeEmbedUrl(l==null?void 0:l.youtube),frameborder:"0",allow:"autoplay; encrypted-media",allowfullscreen:"",style:{width:"100%",height:"100%"}},null,8,X)]),_:2},1024),t(T,{class:"text-body-2 text-secondary"},{default:a(()=>[n("p",null,[s[20]||(s[20]=n("strong",null,"Type:",-1)),o(" "+p(l.freeVideo),1)]),n("p",null,[s[21]||(s[21]=n("strong",null,"Date:",-1)),o(" "+p(l.date),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e.showEnrollButton?(i(),V(b,{key:0,class:"justify-center mt-6 mb-16 handle"},{default:a(()=>[t(g,{color:"primary",large:"",onClick:m.handleEnroll},{default:a(()=>s[22]||(s[22]=[o(" Enroll to Access All Paid Videos ")])),_:1,__:[22]},8,["onClick"])]),_:1})):q("",!0),t(B,{modelValue:e.showForm,"onUpdate:modelValue":s[14]||(s[14]=l=>e.showForm=l),"max-width":"600",style:{height:"730px"}},{default:a(()=>[t(v,{class:"form pa-1",elevation:"4","mb-0":""},{default:a(()=>[t(k,{class:"d-flex justify-space-between align-center"},{default:a(()=>[s[24]||(s[24]=n("span",{class:"text-h4"},"Add User",-1)),t(g,{icon:"",color:"red",onClick:s[0]||(s[0]=l=>e.showForm=!1)},{default:a(()=>[t(O,null,{default:a(()=>s[23]||(s[23]=[o("mdi-close")])),_:1,__:[23]})]),_:1})]),_:1,__:[24]}),t(T,null,{default:a(()=>[t(j,{modelValue:e.startMenu,"onUpdate:modelValue":s[3]||(s[3]=l=>e.startMenu=l),"full-width":"","max-width":"200px","min-width":"290px","close-on-content-click":!1},{activator:a(({props:l})=>[t(u,Y({modelValue:e.user.startDate,"onUpdate:modelValue":s[1]||(s[1]=f=>e.user.startDate=f),density:"compact",variant:"outlined",label:"From Date",readonly:""},l),null,16,["modelValue"])]),default:a(()=>[t(z,{modelValue:e.startPicker,"onUpdate:modelValue":s[2]||(s[2]=l=>e.startPicker=l),color:"primary","hide-header":""},null,8,["modelValue"])]),_:1},8,["modelValue"]),t(u,{label:"Name",modelValue:e.user.name,"onUpdate:modelValue":s[4]||(s[4]=l=>e.user.name=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"]),t(u,{label:"User Name",modelValue:e.user.userName,"onUpdate:modelValue":s[5]||(s[5]=l=>e.user.userName=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"]),t(u,{label:"Age",modelValue:e.user.age,"onUpdate:modelValue":s[6]||(s[6]=l=>e.user.age=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"]),t(u,{modelValue:e.user.nrc,"onUpdate:modelValue":s[7]||(s[7]=l=>e.user.nrc=l),label:"NRC",rules:[e.rules.required,e.rules.nrc],required:""},null,8,["modelValue","rules"]),t(u,{modelValue:e.user.email,"onUpdate:modelValue":s[8]||(s[8]=l=>e.user.email=l),label:"Email",rules:[e.rules.required,e.rules.email],required:""},null,8,["modelValue","rules"]),t(u,{label:"Password",modelValue:e.user.password,"onUpdate:modelValue":s[9]||(s[9]=l=>e.user.password=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"]),t(u,{modelValue:e.user.phonenum,"onUpdate:modelValue":s[10]||(s[10]=l=>e.user.phonenum=l),label:"Phone Number",rules:[e.rules.required,e.rules.phone],required:""},null,8,["modelValue","rules"]),t(u,{label:"Address",modelValue:e.user.address,"onUpdate:modelValue":s[11]||(s[11]=l=>e.user.address=l)},null,8,["modelValue"]),t(u,{label:"Degree",modelValue:e.user.degree,"onUpdate:modelValue":s[12]||(s[12]=l=>e.user.degree=l),rules:[l=>!!l||"required"]},null,8,["modelValue","rules"])]),_:1}),t(N,{class:"justify-end pr-5"},{default:a(()=>[t(g,{class:"text-black",style:{"background-color":"#2196f3"},onClick:s[13]||(s[13]=l=>m.saveUser())},{default:a(()=>[o(p(e.saveOrupdate),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(B,{modelValue:e.dialogBuyNow,"onUpdate:modelValue":s[18]||(s[18]=l=>e.dialogBuyNow=l),width:"500"},{default:a(()=>[t(v,null,{default:a(()=>[t(k,{class:"text-h5 white--text bg-red"},{default:a(()=>s[25]||(s[25]=[o("Buy ")])),_:1,__:[25]}),t(T,{class:"text-h6"},{default:a(()=>[t(G,{modelValue:e.rgType,"onUpdate:modelValue":s[15]||(s[15]=l=>e.rgType=l),inline:""},{default:a(()=>[t(D,{label:"Courses",value:"COURSES"}),t(D,{label:"Exam",value:"EXAM"})]),_:1},8,["modelValue"])]),_:1}),t(N,null,{default:a(()=>[t(H),t(g,{class:"black",text:"",onClick:s[16]||(s[16]=l=>e.dialogBuyNow=!1)},{default:a(()=>s[26]||(s[26]=[o("CANCEL")])),_:1,__:[26]}),t(g,{dark:"",class:"bg-red",text:"",onClick:s[17]||(s[17]=l=>m.clickBuyNowType())},{default:a(()=>s[27]||(s[27]=[o("SAVE")])),_:1,__:[27]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const de=c(J,[["render",K],["__scopeId","data-v-6a489b02"]]);export{de as default};
